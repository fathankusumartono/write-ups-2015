# School CTF Winter 2015: Try to guess

**Category:** Exploit
**Points:** 500
**Solves:** 
**Description:**

> The program uses cutting-edge tech random numbers generator. Hack it!
> 
> 
> nc sibears.ru 10007
> 
> 
> nc sibears.ru 12007
> 
> 
> nc sibears.ru 13007
> 
> 
> [Task_x86](./task7_x86_6cea5e1980e8f3c19e34a1dac4747921d7717a8b) [Task_x86_64](./task7_x86_64_7fcab081788fd56a7144f6f879badb1360aa3e78)


## Write-up

<div><h3>Try to guess</h3><p>In first two client's tries to guess server generates two numbers and sends them. Third try depends on first two, specifically:</p>
<p>There are two global variables first_try and second_try initiated by input/output of two first tries respectively, and one named unguessable that is initiated by them in third try:</p>
<pre><code>first_try = ((input[0] + 1)* output[0] ) % 16 + 1
second_try = (input[1] + 1)* output[1]

unguessable = 0;
for (i = 0; i &lt; first_try; ++i) 
    unguessable ^= rot(second_try, i + 1)
</code></pre>
<p>In order to succeed in third try one must go through the same transformations as server does, which is totally doable, because server sends us generated randoms.</p>
<p>The easiest way to do it is send <code>2^32-1</code> or <code>4294967295</code> twice, which will lead to a 32bit integer overflow (might not on some processors) and turn</p>
<pre><code>first_try=1 and second_try=unguessable=0
</code></pre>
<p>Thus releasing us from writing scripts :-)</p></div>

## Other write-ups and resources

* none yet
